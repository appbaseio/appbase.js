<!DOCTYPE html>
<html>
<head>
    <title>Example</title>
    <script type="text/javascript" src="../dist/appbase.min.js" ></script>
    <script type="text/javascript">
        function startup () {
            var log = console.log.bind(console);
            var error = console.error.bind(console);
            var AppTest = Appbase.app("rest_test", "193dc4d2440146082ea734f36f4f2638");
            var userCollection = AppTest.collection('user');

            userCollection.onDocuments(function(argument) {
                if(typeof(argument) === 'object'){
                    log(argument);
                    document.write("<p style='color:green'>Valid JSON " + JSON.stringify(argument) + "</p>");
                } else {
                    try {
                        JSON.parse(argument);
                    } catch (e){
                        error("Invalid JSON " + argument + "");
                        document.write("<p style='color:red'>Invalid JSON " + argument + "</p>");
                    }
                }
            });

            function test (argument) {
                userCollection.set(new Date().getTime()+'', {
                    name : new Date().getTime()
                });
                    
                setTimeout(function() {
                    test()
                }, 5000);
            }

            test();
            test();
            test();
            test();
        }
    </script>
</head>
<body onLoad="startup()">

</body>
</html>